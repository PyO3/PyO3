Add `#[pyo3(allow_threads)]` to release the GIL in (async) functions